<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="911px" preserveAspectRatio="none" style="width:1416px;height:911px;background:#FFFFFF;" version="1.1" viewBox="0 0 1416 911" width="1416px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="145" x="634.5" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="135" x="639.5" y="27.9951">页面崩溃上报时序图</text><rect fill="#DDDDDD" height="862.6484" style="stroke:#181818;stroke-width:0.5;" width="888.5" x="429.5" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133" x="807.25" y="55.3638">Chrome Extension</text><rect fill="#FFFFFF" height="680.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="78" y="128.5938"/><rect fill="#FFFFFF" height="363.5938" style="stroke:#181818;stroke-width:1.0;" width="10" x="470" y="213.9922"/><rect fill="#FFFFFF" height="488.2578" style="stroke:#181818;stroke-width:1.0;" width="10" x="710" y="320.3906"/><rect fill="#FFFFFF" height="443.9922" style="stroke:#181818;stroke-width:1.0;" width="10" x="1247" y="364.6563"/><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1362" y="750.3828"/><rect fill="none" height="161.7969" style="stroke:#000000;stroke-width:1.5;" width="900.5" x="423.5" y="408.7891"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="83" x2="83" y1="118.5938" y2="826.6484"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="252" x2="252" y1="118.5938" y2="826.6484"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="474.5" x2="474.5" y1="118.5938" y2="826.6484"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="715" x2="715" y1="118.5938" y2="826.6484"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1252" x2="1252" y1="118.5938" y2="826.6484"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1367" x2="1367" y1="118.5938" y2="826.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="59" y="115.292">使用者</text><ellipse cx="83" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M83,58.7969 L83,85.7969 M70,66.7969 L96,66.7969 M83,85.7969 L70,100.7969 M83,85.7969 L96,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="59" y="838.6436">使用者</text><ellipse cx="83" cy="850.4453" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M83,858.4453 L83,885.4453 M70,866.4453 L96,866.4453 M83,885.4453 L70,900.4453 M83,885.4453 L96,900.4453 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="224" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="231" y="107.292">标签页</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="224" y="825.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="231" y="845.6436">标签页</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83" x="433.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="440.5" y="107.292">content.js</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83" x="433.5" y="825.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="440.5" y="845.6436">content.js</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="659" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="666" y="107.292">background.js</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="659" y="825.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="666" y="845.6436">background.js</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="1190" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1197" y="107.292">chrome.storage</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124" x="1190" y="825.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1197" y="845.6436">chrome.storage</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="1324" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1331" y="107.292">Sentry监控</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="1324" y="825.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1331" y="845.6436">Sentry监控</text><rect fill="#FFFFFF" height="680.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="78" y="128.5938"/><rect fill="#FFFFFF" height="363.5938" style="stroke:#181818;stroke-width:1.0;" width="10" x="470" y="213.9922"/><rect fill="#FFFFFF" height="488.2578" style="stroke:#181818;stroke-width:1.0;" width="10" x="710" y="320.3906"/><rect fill="#FFFFFF" height="443.9922" style="stroke:#181818;stroke-width:1.0;" width="10" x="1247" y="364.6563"/><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1362" y="750.3828"/><path d="M5,133.5938 L5,158.5938 L161,158.5938 L161,143.5938 L151,133.5938 L5,133.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M151,133.5938 L151,143.5938 L161,143.5938 L151,133.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="11" y="150.6606">用户访问Web 应用阶段</text><polygon fill="#181818" points="240,180.8594,250,184.8594,240,188.8594,244,184.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="88" x2="246" y1="184.8594" y2="184.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="95" y="179.7935">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="108" y="179.7935">访问 Web 应用地址</text><polygon fill="#181818" points="458,209.9922,468,213.9922,458,217.9922,462,213.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="252" x2="464" y1="213.9922" y2="213.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="259" y="208.9263">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="272" y="208.9263">符合manifest配置中的标签规则</text><path d="M399,226.9922 L399,251.9922 L551,251.9922 L551,236.9922 L541,226.9922 L399,226.9922 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M541,226.9922 L541,236.9922 L551,236.9922 L541,226.9922 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="405" y="244.0591">监听Tab正常挂载/卸载</text><line style="stroke:#181818;stroke-width:1.0;" x1="480" x2="522" y1="278.2578" y2="278.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="522" x2="522" y1="278.2578" y2="291.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="481" x2="522" y1="291.2578" y2="291.2578"/><polygon fill="#181818" points="491,287.2578,481,291.2578,491,295.2578,487,291.2578" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="487" y="273.1919">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="500" y="273.1919">监听页面onload事件 记录页面数据</text><polygon fill="#181818" points="698,316.3906,708,320.3906,698,324.3906,702,320.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="480" x2="704" y1="320.3906" y2="320.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="487" y="315.3247">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="500" y="315.3247">将 page 信息传入</text><polygon fill="#181818" points="1235,360.6563,1245,364.6563,1235,368.6563,1239,364.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="720" x2="1241" y1="364.6563" y2="364.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="727" y="352.0239">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="740" y="344.4575">向 pages 队列中写入 page</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="744" y="359.5903">chrome.storage.local.set({ key: value })</text><polygon fill="#181818" points="731,389.7891,721,393.7891,731,397.7891,727,393.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="725" x2="1246" y1="393.7891" y2="393.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="737" y="388.7231">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="750" y="388.7231">写入成功</text><path d="M423.5,408.7891 L487.5,408.7891 L487.5,415.9219 L477.5,425.9219 L423.5,425.9219 L423.5,408.7891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="161.7969" style="stroke:#000000;stroke-width:1.5;" width="900.5" x="423.5" y="408.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="438.5" y="421.856">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="76" x="502.5" y="420.9995">[页面正常关闭]</text><line style="stroke:#181818;stroke-width:1.0;" x1="480" x2="522" y1="447.0547" y2="447.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="522" x2="522" y1="447.0547" y2="460.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="481" x2="522" y1="460.0547" y2="460.0547"/><polygon fill="#181818" points="491,456.0547,481,460.0547,491,464.0547,487,460.0547" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="487" y="441.9888">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="500" y="441.9888">触发页面 beforeunload 事件</text><polygon fill="#181818" points="698,485.1875,708,489.1875,698,493.1875,702,489.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="480" x2="704" y1="489.1875" y2="489.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="487" y="484.1216">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="500" y="484.1216">找对应的 page</text><polygon fill="#181818" points="1235,529.4531,1245,533.4531,1235,537.4531,1239,533.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="720" x2="1241" y1="533.4531" y2="533.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="727" y="520.8208">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="740" y="513.2544">移除 pages 队列中相应 page</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="744" y="528.3872">chrome.storage.local.remove('key')</text><polygon fill="#181818" points="731,558.5859,721,562.5859,731,566.5859,727,562.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="725" x2="1246" y1="562.5859" y2="562.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="737" y="557.52">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="759" y="557.52">移除成功</text><path d="M46,582.5859 L46,607.5859 L119,607.5859 L119,592.5859 L109,582.5859 L46,582.5859 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M109,582.5859 L109,592.5859 L119,592.5859 L109,582.5859 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="52" y="599.6528">触发时机</text><polygon fill="#181818" points="240,629.8516,250,633.8516,240,637.8516,244,633.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="88" x2="246" y1="633.8516" y2="633.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="95" y="628.7856">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="117" y="628.7856">关闭或刷新崩溃 Tab</text><polygon fill="#181818" points="698,658.9844,708,662.9844,698,666.9844,702,662.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="252" x2="704" y1="662.9844" y2="662.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="259" y="657.9185">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="405" x="281" y="657.9185">触发 chrome.tabs.onRemoved 或者 onUpdated 事件 获取到 tabId</text><polygon fill="#181818" points="1235,688.1172,1245,692.1172,1235,696.1172,1239,692.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="720" x2="1241" y1="692.1172" y2="692.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="727" y="687.0513">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="481" x="749" y="687.0513">通过 tabId 读取 Pages 队列中是否存在 如果存在说明该 tab 未正常 beforeunload</text><polygon fill="#181818" points="731,717.25,721,721.25,731,725.25,727,721.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="725" x2="1246" y1="721.25" y2="721.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="737" y="716.1841">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305" x="759" y="716.1841">找出 Pages 队列中未正常 beforeunload 的那个Tab</text><polygon fill="#181818" points="1350,746.3828,1360,750.3828,1350,754.3828,1354,750.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="720" x2="1356" y1="750.3828" y2="750.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="727" y="745.3169">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="749" y="745.3169">上报崩溃日志</text><polygon fill="#181818" points="731,775.5156,721,779.5156,731,783.5156,727,779.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="725" x2="1361" y1="779.5156" y2="779.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="737" y="774.4497">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="759" y="774.4497">日志上报成功</text><polygon fill="#181818" points="1240,804.6484,1250,808.6484,1240,812.6484,1244,808.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="715" x2="1246" y1="808.6484" y2="808.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="722" y="803.5825">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="309" x="744" y="803.5825">移除 Pages 队列中未正常 beforeunload 的那个 Tab</text></g></svg>